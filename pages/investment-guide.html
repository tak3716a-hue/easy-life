<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>투자 기초 가이드 & 뉴스 - Easy Life</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;500;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FFD700;
            --accent: #00d2ff;
            --accent2: #7b61ff;
            --bg-deep: #05080f;
            --bg-card: rgba(12, 17, 30, 0.9);
            --bg-card-hover: rgba(18, 25, 45, 0.95);
            --border: rgba(0, 210, 255, 0.12);
            --border-hover: rgba(0, 210, 255, 0.35);
            --text: #e4eaf5;
            --text-dim: rgba(228, 234, 245, 0.5);
            --text-mid: rgba(228, 234, 245, 0.7);
            --green: #00e676;
            --red: #ff5252;
            --glow-accent: rgba(0, 210, 255, 0.15);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', 'Inter', sans-serif;
            background: var(--bg-deep);
            min-height: 100vh;
            color: var(--text);
            overflow-x: hidden;
        }

        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                radial-gradient(ellipse 80% 60% at 20% 10%, rgba(0, 210, 255, 0.06), transparent),
                radial-gradient(ellipse 60% 50% at 80% 90%, rgba(123, 97, 255, 0.05), transparent),
                radial-gradient(ellipse 50% 40% at 50% 50%, rgba(255, 215, 0, 0.02), transparent);
            pointer-events: none;
            z-index: 0;
        }

        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(rgba(0, 210, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 210, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border: 1px solid var(--border);
            border-radius: 16px;
            margin-bottom: 20px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .back-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(0, 210, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--accent);
            text-decoration: none;
            font-size: 1.1rem;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: var(--accent);
            color: var(--bg-deep);
            box-shadow: 0 0 20px rgba(0, 210, 255, 0.3);
        }

        .header-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent), var(--accent2));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .live-badge {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            background: rgba(0, 230, 118, 0.08);
            border: 1px solid rgba(0, 230, 118, 0.25);
            border-radius: 20px;
            font-size: 0.78rem;
            font-weight: 500;
            color: var(--green);
        }

        .live-badge .dot {
            width: 6px;
            height: 6px;
            background: var(--green);
            border-radius: 50%;
            animation: pulse 2s infinite;
            box-shadow: 0 0 8px rgba(0, 230, 118, 0.6);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.4; transform: scale(0.8); }
        }

        .update-time {
            font-size: 0.75rem;
            color: var(--text-dim);
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 6px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding: 4px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 14px;
            -webkit-overflow-scrolling: touch;
        }

        .tab-nav::-webkit-scrollbar { display: none; }

        .tab-btn {
            padding: 10px 22px;
            background: transparent;
            border: none;
            border-radius: 10px;
            color: var(--text-dim);
            cursor: pointer;
            font-size: 0.88rem;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.25s;
            font-family: 'Noto Sans KR', sans-serif;
            position: relative;
        }

        .tab-btn:hover {
            color: var(--text);
            background: rgba(255,255,255,0.04);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, rgba(0, 210, 255, 0.15), rgba(123, 97, 255, 0.12));
            color: var(--accent);
            font-weight: 700;
            box-shadow: 0 2px 12px rgba(0, 210, 255, 0.1);
        }

        .tab-btn .tab-icon {
            margin-right: 5px;
        }

        /* Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }

        @media (min-width: 960px) {
            .main-layout {
                grid-template-columns: 360px 1fr;
            }
        }

        /* Guide Section */
        .guide-section {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .guide-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .guide-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent), var(--accent2));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .guide-card:hover, .guide-card.active {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
        }

        .guide-card:hover::before, .guide-card.active::before {
            opacity: 1;
        }

        .guide-card.active {
            box-shadow: 0 4px 24px rgba(0, 210, 255, 0.08);
        }

        .guide-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .guide-card-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(0, 210, 255, 0.1), rgba(123, 97, 255, 0.08));
            border-radius: 10px;
            font-size: 1.2rem;
        }

        .guide-card-info {
            flex: 1;
        }

        .guide-card-title {
            font-weight: 700;
            color: var(--text);
            font-size: 0.95rem;
            margin-bottom: 2px;
        }

        .guide-card-desc {
            font-size: 0.78rem;
            color: var(--text-dim);
        }

        .guide-card-arrow {
            color: var(--text-dim);
            transition: all 0.3s;
            font-size: 0.8rem;
        }

        .guide-card.active .guide-card-arrow {
            color: var(--accent);
            transform: rotate(90deg);
        }

        .guide-detail {
            display: none;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-hover);
            border-radius: 14px;
            padding: 24px;
            animation: slideDown 0.35s ease;
            position: relative;
            overflow: hidden;
        }

        .guide-detail::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--accent), var(--accent2), var(--primary));
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .guide-detail.show { display: block; }

        .guide-detail h3 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 12px;
            font-size: 1.05rem;
        }

        .guide-detail p {
            color: var(--text-mid);
            line-height: 1.8;
            font-size: 0.9rem;
            margin-bottom: 16px;
        }

        .guide-detail ul {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .guide-detail ul li {
            padding: 10px 14px;
            background: rgba(0, 210, 255, 0.03);
            border-radius: 8px;
            color: var(--text-mid);
            font-size: 0.88rem;
            line-height: 1.5;
            border-left: 2px solid rgba(0, 210, 255, 0.2);
            transition: all 0.2s;
        }

        .guide-detail ul li:hover {
            background: rgba(0, 210, 255, 0.06);
            border-left-color: var(--accent);
        }

        .guide-detail ul li strong {
            color: var(--text);
        }

        .keyword-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 16px;
        }

        .keyword-tag {
            display: inline-block;
            padding: 4px 12px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.08), rgba(255, 215, 0, 0.04));
            border: 1px solid rgba(255, 215, 0, 0.2);
            border-radius: 20px;
            font-size: 0.72rem;
            font-weight: 500;
            color: var(--primary);
            letter-spacing: 0.5px;
        }

        /* News Section */
        .news-section {
            display: flex;
            flex-direction: column;
        }

        .news-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 0 4px;
        }

        .news-toolbar h2 {
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .news-toolbar h2 .count {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--accent);
            background: rgba(0, 210, 255, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .news-toolbar-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .refresh-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 7px 16px;
            background: rgba(0, 210, 255, 0.06);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--text-dim);
            cursor: pointer;
            font-size: 0.78rem;
            transition: all 0.3s;
            font-family: 'Noto Sans KR', sans-serif;
        }

        .refresh-btn:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: rgba(0, 210, 255, 0.1);
        }

        .countdown-badge {
            font-size: 0.72rem;
            color: var(--text-dim);
        }

        .countdown-badge span {
            color: var(--accent);
            font-weight: 600;
        }

        /* News List */
        .news-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .news-item {
            display: flex;
            gap: 16px;
            padding: 16px 18px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 14px;
            text-decoration: none;
            color: var(--text);
            transition: all 0.25s;
            animation: fadeIn 0.4s ease both;
        }

        .news-item:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
            transform: translateX(4px);
            box-shadow: 0 4px 20px rgba(0, 210, 255, 0.06);
        }

        .news-thumb {
            width: 100px;
            height: 72px;
            border-radius: 10px;
            object-fit: cover;
            flex-shrink: 0;
            background: linear-gradient(135deg, rgba(0,210,255,0.05), rgba(123,97,255,0.05));
        }

        .news-content {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .news-title {
            font-size: 0.93rem;
            font-weight: 600;
            line-height: 1.5;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            color: var(--text);
            transition: color 0.2s;
        }

        .news-item:hover .news-title {
            color: var(--accent);
        }

        .news-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.75rem;
        }

        .news-source {
            display: flex;
            align-items: center;
            gap: 4px;
            color: var(--accent);
            font-weight: 600;
        }

        .news-source::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 4px;
            background: var(--accent);
            border-radius: 50%;
        }

        .news-time {
            color: var(--text-dim);
        }

        .news-desc {
            font-size: 0.8rem;
            color: var(--text-dim);
            line-height: 1.4;
            margin-top: 4px;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Featured (first) news item */
        .news-item.featured {
            flex-direction: column;
            padding: 0;
            overflow: hidden;
        }

        .news-item.featured .news-thumb {
            width: 100%;
            height: 200px;
            border-radius: 14px 14px 0 0;
        }

        .news-item.featured .news-content {
            padding: 18px 20px 20px;
        }

        .news-item.featured .news-title {
            font-size: 1.1rem;
            font-weight: 700;
            -webkit-line-clamp: 3;
        }

        .news-item.featured .news-desc {
            -webkit-line-clamp: 2;
            display: -webkit-box;
        }

        /* Loading */
        .news-loading {
            text-align: center;
            padding: 80px 20px;
            color: var(--text-dim);
        }

        .spinner {
            width: 36px;
            height: 36px;
            border: 2px solid var(--border);
            border-top: 2px solid var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .news-error {
            text-align: center;
            padding: 50px 20px;
            background: var(--bg-card);
            border: 1px solid rgba(255, 82, 82, 0.2);
            border-radius: 14px;
        }

        .news-error p { color: var(--red); margin-bottom: 8px; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(0,210,255,0.2); border-radius: 4px; }

        /* Responsive */
        @media (max-width: 960px) {
            .header-title { font-size: 1.1rem; }
            .guide-section {
                flex-direction: row;
                overflow-x: auto;
                padding-bottom: 4px;
                -webkit-overflow-scrolling: touch;
            }
            .guide-section::-webkit-scrollbar { display: none; }
            .guide-card { min-width: 200px; flex-shrink: 0; }
            .guide-detail { min-width: 100%; }
            .news-item.featured .news-thumb { height: 160px; }
        }

        @media (max-width: 600px) {
            .container { padding: 12px; }
            .header { padding: 12px 16px; border-radius: 12px; }
            .header-title { font-size: 1rem; }
            .update-time { display: none; }
            .news-thumb { width: 80px; height: 58px; }
            .news-title { font-size: 0.88rem; }
            .news-item.featured .news-title { font-size: 1rem; }
            .tab-btn { padding: 8px 16px; font-size: 0.82rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <a href="finance.html" class="back-btn">&#8592;</a>
                <h1 class="header-title">INVEST GUIDE</h1>
            </div>
            <div class="header-right">
                <div class="live-badge">
                    <span class="dot"></span>
                    LIVE
                </div>
                <span class="update-time" id="updateStatus">업데이트 대기중</span>
            </div>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="all"><span class="tab-icon">&#9733;</span> 전체</button>
            <button class="tab-btn" data-tab="guide"><span class="tab-icon">&#9776;</span> 투자 기초</button>
            <button class="tab-btn" data-tab="stock"><span class="tab-icon">&#9650;</span> 주식</button>
            <button class="tab-btn" data-tab="economy"><span class="tab-icon">&#9670;</span> 경제</button>
            <button class="tab-btn" data-tab="crypto"><span class="tab-icon">&#9741;</span> 가상자산</button>
            <button class="tab-btn" data-tab="realestate"><span class="tab-icon">&#9632;</span> 부동산</button>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Guide Sidebar -->
            <div class="guide-section" id="guideSection">
                <div class="guide-card" data-guide="stock" onclick="toggleGuide('stock')">
                    <div class="guide-card-header">
                        <div class="guide-card-icon">&#128200;</div>
                        <div class="guide-card-info">
                            <div class="guide-card-title">주식 기초</div>
                            <div class="guide-card-desc">매매 방법과 기본 용어</div>
                        </div>
                        <span class="guide-card-arrow">&#9654;</span>
                    </div>
                </div>
                <div class="guide-detail" id="guide-stock">
                    <h3>주식 투자 기초</h3>
                    <p>주식은 기업의 소유권을 나타내는 증권입니다. 주식을 구매하면 해당 기업의 주주가 되어 이익 배당과 의결권을 갖게 됩니다.</p>
                    <ul>
                        <li><strong>보통주</strong> — 의결권이 있는 일반 주식. 배당금은 변동적</li>
                        <li><strong>우선주</strong> — 의결권 없지만 배당을 우선적으로 받음</li>
                        <li><strong>시가총액</strong> — 주가 x 발행주식수. 기업의 시장 가치</li>
                        <li><strong>PER (주가수익비율)</strong> — 주가 / 주당순이익. 낮을수록 저평가 가능성</li>
                        <li><strong>PBR (주가순자산비율)</strong> — 주가 / 주당순자산. 1 미만이면 자산가치 이하</li>
                        <li><strong>EPS (주당순이익)</strong> — 순이익 / 발행주식수</li>
                        <li><strong>배당수익률</strong> — 주당배당금 / 주가 x 100</li>
                    </ul>
                    <div class="keyword-tags">
                        <span class="keyword-tag">가치투자</span>
                        <span class="keyword-tag">성장투자</span>
                        <span class="keyword-tag">배당투자</span>
                    </div>
                </div>

                <div class="guide-card" data-guide="etf" onclick="toggleGuide('etf')">
                    <div class="guide-card-header">
                        <div class="guide-card-icon">&#128202;</div>
                        <div class="guide-card-info">
                            <div class="guide-card-title">ETF & 펀드</div>
                            <div class="guide-card-desc">분산투자의 핵심</div>
                        </div>
                        <span class="guide-card-arrow">&#9654;</span>
                    </div>
                </div>
                <div class="guide-detail" id="guide-etf">
                    <h3>ETF & 펀드 기초</h3>
                    <p>ETF(상장지수펀드)는 특정 지수를 추종하는 펀드를 주식처럼 거래할 수 있는 상품입니다.</p>
                    <ul>
                        <li><strong>ETF</strong> — 거래소에서 실시간 매매 가능. 낮은 수수료</li>
                        <li><strong>인덱스 펀드</strong> — 특정 지수(코스피200 등)를 그대로 추종</li>
                        <li><strong>액티브 펀드</strong> — 펀드매니저가 능동적으로 종목 선정</li>
                        <li><strong>레버리지 ETF</strong> — 지수 변동의 2배 추종 (위험 높음)</li>
                        <li><strong>인버스 ETF</strong> — 지수 하락 시 수익 (하락장 헷지)</li>
                        <li><strong>총보수(TER)</strong> — 연간 운용 비용. 낮을수록 유리</li>
                    </ul>
                    <div class="keyword-tags">
                        <span class="keyword-tag">분산투자</span>
                        <span class="keyword-tag">패시브</span>
                        <span class="keyword-tag">저비용</span>
                    </div>
                </div>

                <div class="guide-card" data-guide="bond" onclick="toggleGuide('bond')">
                    <div class="guide-card-header">
                        <div class="guide-card-icon">&#127974;</div>
                        <div class="guide-card-info">
                            <div class="guide-card-title">채권 기초</div>
                            <div class="guide-card-desc">안정적 수익의 대명사</div>
                        </div>
                        <span class="guide-card-arrow">&#9654;</span>
                    </div>
                </div>
                <div class="guide-detail" id="guide-bond">
                    <h3>채권 투자 기초</h3>
                    <p>채권은 정부나 기업이 자금을 빌리면서 발행하는 차용증서입니다. 정해진 이자를 받고 만기에 원금을 상환받습니다.</p>
                    <ul>
                        <li><strong>국채</strong> — 정부 발행. 가장 안전한 채권</li>
                        <li><strong>회사채</strong> — 기업 발행. 신용등급에 따라 금리 상이</li>
                        <li><strong>표면금리(쿠폰)</strong> — 액면가 기준 연간 이자율</li>
                        <li><strong>만기수익률(YTM)</strong> — 만기까지 보유 시 총 수익률</li>
                        <li><strong>듀레이션</strong> — 금리 변동에 대한 채권 가격 민감도</li>
                        <li><strong>금리 상승 = 채권가격 하락</strong> — 역의 관계 핵심 원리</li>
                    </ul>
                    <div class="keyword-tags">
                        <span class="keyword-tag">안정성</span>
                        <span class="keyword-tag">이자수익</span>
                        <span class="keyword-tag">금리</span>
                    </div>
                </div>

                <div class="guide-card" data-guide="risk" onclick="toggleGuide('risk')">
                    <div class="guide-card-header">
                        <div class="guide-card-icon">&#128737;</div>
                        <div class="guide-card-info">
                            <div class="guide-card-title">리스크 관리</div>
                            <div class="guide-card-desc">수익보다 중요한 것</div>
                        </div>
                        <span class="guide-card-arrow">&#9654;</span>
                    </div>
                </div>
                <div class="guide-detail" id="guide-risk">
                    <h3>리스크 관리 원칙</h3>
                    <p>성공적인 투자의 핵심은 높은 수익이 아니라 리스크를 관리하는 것입니다.</p>
                    <ul>
                        <li><strong>분산투자</strong> — 자산을 여러 종목/섹터/국가에 나눠 투자</li>
                        <li><strong>자산배분</strong> — 주식:채권:현금 비율을 정해 리밸런싱</li>
                        <li><strong>손절매</strong> — 손실 한도를 미리 정해두고 기계적 실행</li>
                        <li><strong>포지션 사이징</strong> — 한 종목에 전체 자산의 5~10% 이내</li>
                        <li><strong>적립식 투자 (DCA)</strong> — 정기적으로 일정 금액 투자</li>
                        <li><strong>비상자금</strong> — 6개월 생활비를 현금으로 별도 확보</li>
                    </ul>
                    <div class="keyword-tags">
                        <span class="keyword-tag">분산</span>
                        <span class="keyword-tag">손절</span>
                        <span class="keyword-tag">DCA</span>
                    </div>
                </div>
            </div>

            <!-- News Feed -->
            <div class="news-section">
                <div class="news-toolbar">
                    <h2>
                        최신 뉴스
                        <span class="count" id="newsCount">-</span>
                    </h2>
                    <div class="news-toolbar-right">
                        <span class="countdown-badge">
                            <span id="countdown">60</span>초 후 갱신
                        </span>
                        <button class="refresh-btn" onclick="fetchNews()">&#8635; 새로고침</button>
                    </div>
                </div>
                <div class="news-list" id="newsList">
                    <div class="news-loading">
                        <div class="spinner"></div>
                        <p>최신 뉴스를 불러오는 중...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab navigation
        const tabBtns = document.querySelectorAll('.tab-btn');
        let currentTab = 'all';

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentTab = btn.dataset.tab;

                if (currentTab === 'guide') {
                    document.getElementById('guideSection').style.display = 'flex';
                    document.querySelector('.news-section').style.display = 'none';
                } else {
                    document.getElementById('guideSection').style.display = '';
                    document.querySelector('.news-section').style.display = '';
                    fetchNews();
                }
            });
        });

        // Guide toggle
        function toggleGuide(id) {
            const detail = document.getElementById('guide-' + id);
            const card = document.querySelector(`.guide-card[data-guide="${id}"]`);
            const isShowing = detail.classList.contains('show');

            document.querySelectorAll('.guide-detail').forEach(d => d.classList.remove('show'));
            document.querySelectorAll('.guide-card').forEach(c => c.classList.remove('active'));

            if (!isShowing) {
                detail.classList.add('show');
                card.classList.add('active');
            }
        }

        // News feed
        const NEWS_API = '../api/news';

        let refreshTimer;
        let countdownTimer;
        let countdownValue = 60;

        function getTimeAgo(dateStr) {
            const now = new Date();
            const date = new Date(dateStr);
            const diff = Math.floor((now - date) / 1000);

            if (isNaN(diff) || diff < 0) return '';
            if (diff < 60) return '방금 전';
            if (diff < 3600) return Math.floor(diff / 60) + '분 전';
            if (diff < 86400) return Math.floor(diff / 3600) + '시간 전';
            return Math.floor(diff / 86400) + '일 전';
        }

        function extractSource(title) {
            const match = title.match(/[-\u2013\u2014]\s*(.+)$/);
            return match ? match[1].trim() : '';
        }

        function cleanTitle(title) {
            return title.replace(/\s*[-\u2013\u2014]\s*[^\-\u2013\u2014]+$/, '').trim() || title;
        }

        async function fetchNews() {
            const newsList = document.getElementById('newsList');
            const category = (currentTab === 'guide') ? 'all' : currentTab;

            newsList.innerHTML = `
                <div class="news-loading">
                    <div class="spinner"></div>
                    <p>최신 뉴스를 불러오는 중...</p>
                </div>
            `;

            try {
                const response = await fetch(`${NEWS_API}/${category}.json?t=${Date.now()}`);
                const allItems = await response.json();

                if (allItems.length > 0) {
                    newsList.innerHTML = '';
                    document.getElementById('newsCount').textContent = allItems.length;

                    allItems.forEach((item, index) => {
                        const rawTitle = item.title;
                        const title = cleanTitle(rawTitle);
                        const source = item.author || extractSource(rawTitle) || '뉴스';
                        const timeAgo = getTimeAgo(item.pubDate);
                        const thumbnail = item.thumbnail || '';
                        const desc = item.description || '';
                        const isFeatured = index === 0 && thumbnail;

                        const newsEl = document.createElement('a');
                        newsEl.className = 'news-item' + (isFeatured ? ' featured' : '');
                        newsEl.href = item.link;
                        newsEl.target = '_blank';
                        newsEl.rel = 'noopener noreferrer';
                        newsEl.style.animationDelay = `${index * 0.04}s`;

                        if (isFeatured) {
                            newsEl.innerHTML = `
                                <img class="news-thumb" src="${thumbnail}" alt="" onerror="this.style.display='none'">
                                <div class="news-content">
                                    <div class="news-title">${title}</div>
                                    ${desc ? `<div class="news-desc">${desc}</div>` : ''}
                                    <div class="news-meta" style="margin-top:10px">
                                        <span class="news-source">${source}</span>
                                        <span class="news-time">${timeAgo}</span>
                                    </div>
                                </div>
                            `;
                        } else {
                            newsEl.innerHTML = `
                                ${thumbnail ? `<img class="news-thumb" src="${thumbnail}" alt="" onerror="this.style.display='none'">` : ''}
                                <div class="news-content">
                                    <div class="news-title">${title}</div>
                                    <div class="news-meta">
                                        <span class="news-source">${source}</span>
                                        <span class="news-time">${timeAgo}</span>
                                    </div>
                                </div>
                            `;
                        }

                        newsList.appendChild(newsEl);
                    });

                    document.getElementById('updateStatus').textContent =
                        new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' }) + ' 업데이트';
                } else {
                    throw new Error('뉴스를 찾을 수 없습니다');
                }
            } catch (error) {
                newsList.innerHTML = `
                    <div class="news-error">
                        <p>뉴스를 불러오지 못했습니다</p>
                        <p style="font-size:0.82rem; color:var(--text-dim);">${error.message}</p>
                        <button class="refresh-btn" onclick="fetchNews()" style="margin-top:15px;">다시 시도</button>
                    </div>
                `;
            }

            resetCountdown();
        }

        function resetCountdown() {
            countdownValue = 60;
            clearInterval(refreshTimer);
            clearInterval(countdownTimer);

            countdownTimer = setInterval(() => {
                countdownValue--;
                document.getElementById('countdown').textContent = countdownValue;
                if (countdownValue <= 0) {
                    clearInterval(countdownTimer);
                }
            }, 1000);

            refreshTimer = setTimeout(() => {
                fetchNews();
            }, 60000);
        }

        // Initial load
        fetchNews();
    </script>
</body>
</html>
