<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>바카라 - Easy Life</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FFD700;
            --secondary: #1a1a2e;
            --player: #2563eb;
            --banker: #dc2626;
            --tie: #16a34a;
            --felt: #0d5c2e;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            min-height: 100vh;
            color: white;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            padding: 15px;
        }

        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            border-radius: 10px;
            color: #4ecdc4;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .back-btn:hover {
            background: #4ecdc4;
            color: var(--secondary);
        }

        header {
            text-align: center;
            padding: 10px;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            color: var(--primary);
        }

        .game-layout {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 20px;
        }

        @media (max-width: 1000px) {
            .game-layout {
                grid-template-columns: 1fr;
            }
        }

        /* 메인 게임 영역 */
        .main-game {
            background: var(--felt);
            border-radius: 20px;
            padding: 25px;
            border: 5px solid #8B4513;
        }

        /* 카드 테이블 */
        .card-table {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .hand-area {
            text-align: center;
        }

        .hand-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem;
            padding: 10px 25px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: inline-block;
        }

        .hand-label.player {
            background: linear-gradient(135deg, var(--player), #1d4ed8);
            color: white;
        }

        .hand-label.banker {
            background: linear-gradient(135deg, var(--banker), #b91c1c);
            color: white;
        }

        .cards-container {
            display: flex;
            justify-content: center;
            gap: 8px;
            min-height: 130px;
            align-items: center;
        }

        .card {
            width: 80px;
            height: 115px;
            background: white;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.4);
            position: relative;
            transform-style: preserve-3d;
            animation: dealCard 0.5s ease-out;
        }

        .card.red { color: #dc2626; }
        .card.black { color: #1f2937; }

        .card-suit {
            font-size: 1.2rem;
        }

        .card.third {
            transform: rotate(90deg);
            margin-left: 5px;
        }

        .score-display {
            margin-top: 15px;
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5rem;
            font-weight: bold;
        }

        .score-display.player { color: var(--player); text-shadow: 0 0 20px rgba(37, 99, 235, 0.5); }
        .score-display.banker { color: var(--banker); text-shadow: 0 0 20px rgba(220, 38, 38, 0.5); }

        /* 결과 표시 */
        .result-banner {
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: bold;
            display: none;
        }

        .result-banner.player-win {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.3), rgba(37, 99, 235, 0.1));
            border: 2px solid var(--player);
            color: var(--player);
        }

        .result-banner.banker-win {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.3), rgba(220, 38, 38, 0.1));
            border: 2px solid var(--banker);
            color: var(--banker);
        }

        .result-banner.tie {
            background: linear-gradient(135deg, rgba(22, 163, 74, 0.3), rgba(22, 163, 74, 0.1));
            border: 2px solid var(--tie);
            color: var(--tie);
        }

        /* 베팅 영역 */
        .betting-area {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .bet-zone {
            width: 140px;
            height: 90px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid rgba(255,255,255,0.3);
            position: relative;
        }

        .bet-zone:hover {
            transform: scale(1.05);
            border-color: var(--primary);
        }

        .bet-zone.selected {
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
            border-color: var(--primary);
        }

        .bet-zone.player-zone {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.4), rgba(37, 99, 235, 0.2));
        }

        .bet-zone.tie-zone {
            background: linear-gradient(135deg, rgba(22, 163, 74, 0.4), rgba(22, 163, 74, 0.2));
        }

        .bet-zone.banker-zone {
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.4), rgba(220, 38, 38, 0.2));
        }

        .bet-zone-label {
            font-weight: bold;
            font-size: 1rem;
        }

        .bet-zone-odds {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .bet-zone-amount {
            position: absolute;
            bottom: -10px;
            background: var(--primary);
            color: black;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* 칩 선택 */
        .chip-area {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .chip {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px dashed rgba(255,255,255,0.5);
            cursor: pointer;
            font-weight: bold;
            font-size: 0.75rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chip:hover, .chip.selected {
            transform: scale(1.15);
            box-shadow: 0 0 15px rgba(255,255,255,0.5);
        }

        .chip-1 { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }
        .chip-5 { background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; }
        .chip-25 { background: linear-gradient(135deg, #22c55e, #16a34a); color: white; }
        .chip-100 { background: linear-gradient(135deg, #1f2937, #111827); color: var(--primary); }
        .chip-500 { background: linear-gradient(135deg, #a855f7, #9333ea); color: white; }

        /* 컨트롤 버튼 */
        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        .ctrl-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ctrl-btn:hover:not(:disabled) {
            transform: scale(1.02);
        }

        .ctrl-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .deal-btn {
            background: linear-gradient(135deg, var(--primary), #f59e0b);
            color: var(--secondary);
            flex: 2;
        }

        .clear-btn {
            background: rgba(255,255,255,0.1);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .rebet-btn {
            background: rgba(168, 85, 247, 0.3);
            color: white;
            border: 1px solid #a855f7;
        }

        /* 밸런스 */
        .balance-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            margin-top: 15px;
        }

        .balance-info {
            font-family: 'Orbitron', sans-serif;
        }

        .balance-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.7);
        }

        .balance-value {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .win-info {
            text-align: right;
        }

        .win-amount {
            font-size: 1.2rem;
            color: #22c55e;
        }

        /* 사이드 패널 - 로드맵 */
        .side-panel {
            background: rgba(26, 26, 46, 0.9);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .panel-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--primary);
            font-size: 1rem;
            margin-bottom: 10px;
            text-align: center;
        }

        /* 빅로드 */
        .roadmap {
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 15px;
        }

        .roadmap-title {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
            margin-bottom: 8px;
        }

        .road-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 2px;
        }

        .road-cell {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .road-cell.player { background: var(--player); }
        .road-cell.banker { background: var(--banker); }
        .road-cell.tie { background: var(--tie); }

        /* 통계 */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }

        .stat-box {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
        }

        .stat-box.player { background: rgba(37, 99, 235, 0.2); }
        .stat-box.banker { background: rgba(220, 38, 38, 0.2); }
        .stat-box.tie { background: rgba(22, 163, 74, 0.2); }

        .stat-count {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .stat-box.player .stat-count { color: var(--player); }
        .stat-box.banker .stat-count { color: var(--banker); }
        .stat-box.tie .stat-count { color: var(--tie); }

        .stat-label {
            font-size: 0.75rem;
            color: rgba(255,255,255,0.7);
        }

        /* 슈 정보 */
        .shoe-info {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .shoe-label {
            font-size: 0.8rem;
            color: rgba(255,255,255,0.6);
        }

        .shoe-cards {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--primary);
        }

        .new-shoe-btn {
            margin-top: 10px;
            padding: 8px 15px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .new-shoe-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        @keyframes dealCard {
            from {
                transform: translateY(-100px) rotate(-10deg);
                opacity: 0;
            }
            to {
                transform: translateY(0) rotate(0);
                opacity: 1;
            }
        }

        @keyframes dealCardThird {
            from {
                transform: translateY(-100px) rotate(80deg);
                opacity: 0;
            }
            to {
                transform: translateY(0) rotate(90deg);
                opacity: 1;
            }
        }

        .card.third {
            animation: dealCardThird 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="casino.html" class="back-btn">← 카지노</a>

        <header>
            <h1>BACCARAT</h1>
        </header>

        <div class="game-layout">
            <div class="main-game">
                <!-- 결과 배너 -->
                <div class="result-banner" id="resultBanner"></div>

                <!-- 카드 테이블 -->
                <div class="card-table">
                    <div class="hand-area">
                        <div class="hand-label player">PLAYER</div>
                        <div class="cards-container" id="playerCards"></div>
                        <div class="score-display player" id="playerScore">-</div>
                    </div>
                    <div class="hand-area">
                        <div class="hand-label banker">BANKER</div>
                        <div class="cards-container" id="bankerCards"></div>
                        <div class="score-display banker" id="bankerScore">-</div>
                    </div>
                </div>

                <!-- 베팅 영역 -->
                <div class="betting-area">
                    <div class="bet-zone player-zone" onclick="selectBetZone('player')">
                        <span class="bet-zone-label">PLAYER</span>
                        <span class="bet-zone-odds">1:1</span>
                        <span class="bet-zone-amount" id="playerBetAmount" style="display:none;">$0</span>
                    </div>
                    <div class="bet-zone tie-zone" onclick="selectBetZone('tie')">
                        <span class="bet-zone-label">TIE</span>
                        <span class="bet-zone-odds">8:1</span>
                        <span class="bet-zone-amount" id="tieBetAmount" style="display:none;">$0</span>
                    </div>
                    <div class="bet-zone banker-zone" onclick="selectBetZone('banker')">
                        <span class="bet-zone-label">BANKER</span>
                        <span class="bet-zone-odds">0.95:1</span>
                        <span class="bet-zone-amount" id="bankerBetAmount" style="display:none;">$0</span>
                    </div>
                </div>

                <!-- 칩 선택 -->
                <div class="chip-area">
                    <div class="chip chip-1" onclick="selectChip(1)">$1</div>
                    <div class="chip chip-5" onclick="selectChip(5)">$5</div>
                    <div class="chip chip-25" onclick="selectChip(25)">$25</div>
                    <div class="chip chip-100" onclick="selectChip(100)">$100</div>
                    <div class="chip chip-500" onclick="selectChip(500)">$500</div>
                </div>

                <!-- 컨트롤 -->
                <div class="controls">
                    <button class="ctrl-btn clear-btn" onclick="clearBets()">취소</button>
                    <button class="ctrl-btn rebet-btn" onclick="rebet()">리벳</button>
                    <button class="ctrl-btn deal-btn" id="dealBtn" onclick="deal()">DEAL</button>
                </div>

                <!-- 밸런스 바 -->
                <div class="balance-bar">
                    <div class="balance-info">
                        <div class="balance-label">잔액</div>
                        <div class="balance-value">$<span id="balance">10000</span></div>
                    </div>
                    <div class="win-info">
                        <div class="balance-label">획득</div>
                        <div class="win-amount" id="winAmount">$0</div>
                    </div>
                </div>
            </div>

            <!-- 사이드 패널 -->
            <div class="side-panel">
                <div class="panel-title">SCOREBOARD</div>

                <!-- 통계 -->
                <div class="stats-grid">
                    <div class="stat-box player">
                        <div class="stat-count" id="playerWins">0</div>
                        <div class="stat-label">PLAYER</div>
                    </div>
                    <div class="stat-box tie">
                        <div class="stat-count" id="tieWins">0</div>
                        <div class="stat-label">TIE</div>
                    </div>
                    <div class="stat-box banker">
                        <div class="stat-count" id="bankerWins">0</div>
                        <div class="stat-label">BANKER</div>
                    </div>
                </div>

                <!-- 빅로드 -->
                <div class="roadmap">
                    <div class="roadmap-title">Big Road</div>
                    <div class="road-grid" id="bigRoad"></div>
                </div>

                <!-- 슈 정보 -->
                <div class="shoe-info">
                    <div class="shoe-label">남은 카드</div>
                    <div class="shoe-cards"><span id="cardsLeft">416</span>장</div>
                    <button class="new-shoe-btn" onclick="newShoe()">새 슈</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 게임 상태
        let balance = parseInt(localStorage.getItem('baccarat_balance') || '10000');
        let selectedChip = 25;
        let bets = { player: 0, banker: 0, tie: 0 };
        let lastBets = { player: 0, banker: 0, tie: 0 };
        let isDealing = false;
        let shoe = [];
        let history = [];
        let stats = { player: 0, banker: 0, tie: 0 };

        // 초기화
        document.getElementById('balance').textContent = balance;
        selectChip(25);
        initRoadmap();
        newShoe();

        // 8덱 슈 생성
        function newShoe() {
            shoe = [];
            const suits = ['♠', '♥', '♦', '♣'];
            const values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

            for (let d = 0; d < 8; d++) {
                for (const suit of suits) {
                    for (const value of values) {
                        shoe.push({ suit, value });
                    }
                }
            }

            // 셔플
            for (let i = shoe.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shoe[i], shoe[j]] = [shoe[j], shoe[i]];
            }

            // 히스토리 & 통계 초기화
            history = [];
            stats = { player: 0, banker: 0, tie: 0 };
            updateStats();
            initRoadmap();
            updateCardsLeft();
        }

        function updateCardsLeft() {
            document.getElementById('cardsLeft').textContent = shoe.length;
        }

        function drawCard() {
            if (shoe.length < 6) newShoe();
            return shoe.pop();
        }

        function getCardValue(card) {
            if (['10', 'J', 'Q', 'K'].includes(card.value)) return 0;
            if (card.value === 'A') return 1;
            return parseInt(card.value);
        }

        function calculateScore(cards) {
            return cards.reduce((sum, card) => sum + getCardValue(card), 0) % 10;
        }

        function createCardElement(card, isThird = false) {
            const el = document.createElement('div');
            const isRed = ['♥', '♦'].includes(card.suit);
            el.className = `card ${isRed ? 'red' : 'black'} ${isThird ? 'third' : ''}`;
            el.innerHTML = `
                <span>${card.value}</span>
                <span class="card-suit">${card.suit}</span>
            `;
            return el;
        }

        function selectChip(value) {
            selectedChip = value;
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('selected'));
            document.querySelector(`.chip-${value}`).classList.add('selected');
        }

        function selectBetZone(zone) {
            if (isDealing) return;
            if (balance < selectedChip) {
                alert('잔액이 부족합니다!');
                return;
            }

            bets[zone] += selectedChip;
            balance -= selectedChip;
            updateBetDisplay();
            updateBalance();
        }

        function updateBetDisplay() {
            ['player', 'banker', 'tie'].forEach(zone => {
                const el = document.getElementById(`${zone}BetAmount`);
                if (bets[zone] > 0) {
                    el.textContent = `$${bets[zone]}`;
                    el.style.display = 'block';
                } else {
                    el.style.display = 'none';
                }
            });
        }

        function updateBalance() {
            document.getElementById('balance').textContent = balance;
            localStorage.setItem('baccarat_balance', balance);
        }

        function clearBets() {
            if (isDealing) return;
            balance += bets.player + bets.banker + bets.tie;
            bets = { player: 0, banker: 0, tie: 0 };
            updateBetDisplay();
            updateBalance();
        }

        function rebet() {
            if (isDealing) return;
            const totalLast = lastBets.player + lastBets.banker + lastBets.tie;
            if (totalLast === 0) return;
            if (balance < totalLast) {
                alert('잔액이 부족합니다!');
                return;
            }

            bets = { ...lastBets };
            balance -= totalLast;
            updateBetDisplay();
            updateBalance();
        }

        function deal() {
            if (isDealing) return;
            const totalBet = bets.player + bets.banker + bets.tie;
            if (totalBet === 0) {
                alert('먼저 베팅하세요!');
                return;
            }

            isDealing = true;
            lastBets = { ...bets };
            document.getElementById('dealBtn').disabled = true;
            document.getElementById('resultBanner').style.display = 'none';
            document.getElementById('winAmount').textContent = '$0';

            // 카드 초기화
            document.getElementById('playerCards').innerHTML = '';
            document.getElementById('bankerCards').innerHTML = '';
            document.getElementById('playerScore').textContent = '-';
            document.getElementById('bankerScore').textContent = '-';

            // 카드 배분
            const playerHand = [drawCard(), drawCard()];
            const bankerHand = [drawCard(), drawCard()];

            let delay = 0;

            // 초기 카드 배분 애니메이션
            setTimeout(() => {
                document.getElementById('playerCards').appendChild(createCardElement(playerHand[0]));
            }, delay += 300);

            setTimeout(() => {
                document.getElementById('bankerCards').appendChild(createCardElement(bankerHand[0]));
            }, delay += 300);

            setTimeout(() => {
                document.getElementById('playerCards').appendChild(createCardElement(playerHand[1]));
            }, delay += 300);

            setTimeout(() => {
                document.getElementById('bankerCards').appendChild(createCardElement(bankerHand[1]));
            }, delay += 300);

            setTimeout(() => {
                let playerScore = calculateScore(playerHand);
                let bankerScore = calculateScore(bankerHand);

                document.getElementById('playerScore').textContent = playerScore;
                document.getElementById('bankerScore').textContent = bankerScore;

                // 내추럴 체크
                if (playerScore >= 8 || bankerScore >= 8) {
                    setTimeout(() => showResult(playerHand, bankerHand), 500);
                    return;
                }

                // 3번째 카드 규칙
                let playerThird = null;
                let bankerThird = null;
                let thirdDelay = 500;

                // 플레이어 3번째 카드
                if (playerScore <= 5) {
                    playerThird = drawCard();
                    playerHand.push(playerThird);

                    setTimeout(() => {
                        document.getElementById('playerCards').appendChild(createCardElement(playerThird, true));
                        playerScore = calculateScore(playerHand);
                        document.getElementById('playerScore').textContent = playerScore;
                    }, thirdDelay);

                    thirdDelay += 600;
                }

                // 뱅커 3번째 카드 규칙
                setTimeout(() => {
                    const shouldBankerDraw = checkBankerDraw(bankerScore, playerThird);

                    if (shouldBankerDraw) {
                        bankerThird = drawCard();
                        bankerHand.push(bankerThird);

                        document.getElementById('bankerCards').appendChild(createCardElement(bankerThird, true));
                        bankerScore = calculateScore(bankerHand);
                        document.getElementById('bankerScore').textContent = bankerScore;
                    }

                    setTimeout(() => showResult(playerHand, bankerHand), 600);
                }, thirdDelay);

            }, delay += 400);
        }

        function checkBankerDraw(bankerScore, playerThirdCard) {
            // 플레이어가 스탠드한 경우
            if (!playerThirdCard) {
                return bankerScore <= 5;
            }

            const p3 = getCardValue(playerThirdCard);

            switch (bankerScore) {
                case 0:
                case 1:
                case 2:
                    return true;
                case 3:
                    return p3 !== 8;
                case 4:
                    return p3 >= 2 && p3 <= 7;
                case 5:
                    return p3 >= 4 && p3 <= 7;
                case 6:
                    return p3 === 6 || p3 === 7;
                default:
                    return false;
            }
        }

        function showResult(playerHand, bankerHand) {
            const playerScore = calculateScore(playerHand);
            const bankerScore = calculateScore(bankerHand);

            let winner;
            let resultText;
            const banner = document.getElementById('resultBanner');

            if (playerScore > bankerScore) {
                winner = 'player';
                resultText = 'PLAYER WINS!';
                banner.className = 'result-banner player-win';
                stats.player++;
            } else if (bankerScore > playerScore) {
                winner = 'banker';
                resultText = 'BANKER WINS!';
                banner.className = 'result-banner banker-win';
                stats.banker++;
            } else {
                winner = 'tie';
                resultText = 'TIE!';
                banner.className = 'result-banner tie';
                stats.tie++;
            }

            banner.textContent = resultText;
            banner.style.display = 'block';

            // 히스토리 추가
            history.push(winner);
            updateRoadmap();
            updateStats();

            // 배당 계산
            let winAmount = 0;

            if (winner === 'player' && bets.player > 0) {
                winAmount += bets.player * 2;
            }
            if (winner === 'banker' && bets.banker > 0) {
                winAmount += bets.banker * 1.95; // 5% 커미션
            }
            if (winner === 'tie') {
                // 타이시 플레이어/뱅커 베팅은 반환
                winAmount += bets.player + bets.banker;
                if (bets.tie > 0) {
                    winAmount += bets.tie * 9; // 8:1 + 원금
                }
            }

            winAmount = Math.floor(winAmount);
            balance += winAmount;

            const profit = winAmount - (bets.player + bets.banker + bets.tie);
            document.getElementById('winAmount').textContent = profit >= 0 ? `+$${profit}` : `-$${Math.abs(profit)}`;
            document.getElementById('winAmount').style.color = profit >= 0 ? '#22c55e' : '#ef4444';

            updateBalance();
            updateCardsLeft();

            // 베팅 초기화
            bets = { player: 0, banker: 0, tie: 0 };
            updateBetDisplay();

            isDealing = false;
            document.getElementById('dealBtn').disabled = false;
        }

        function updateStats() {
            document.getElementById('playerWins').textContent = stats.player;
            document.getElementById('bankerWins').textContent = stats.banker;
            document.getElementById('tieWins').textContent = stats.tie;
        }

        function initRoadmap() {
            const grid = document.getElementById('bigRoad');
            grid.innerHTML = '';
            for (let i = 0; i < 72; i++) {
                const cell = document.createElement('div');
                cell.className = 'road-cell';
                grid.appendChild(cell);
            }
        }

        function updateRoadmap() {
            const cells = document.querySelectorAll('.road-cell');
            let col = 0;
            let row = 0;
            let prevWinner = null;

            cells.forEach(cell => cell.className = 'road-cell');

            history.forEach((winner, index) => {
                if (winner === 'tie') {
                    // 타이는 이전 셀에 표시
                    if (index > 0) {
                        const prevIndex = (col > 0 ? col - 1 : 0) * 6 + Math.min(row, 5);
                        if (prevIndex < 72) {
                            // 타이 마커 추가 (간단히 표시)
                        }
                    }
                    return;
                }

                if (winner !== prevWinner && prevWinner !== null) {
                    col++;
                    row = 0;
                }

                const cellIndex = col * 6 + row;
                if (cellIndex < 72) {
                    cells[cellIndex].classList.add(winner);
                }

                row++;
                if (row >= 6) {
                    col++;
                    row = 0;
                }

                prevWinner = winner;
            });
        }
    </script>
</body>
</html>
